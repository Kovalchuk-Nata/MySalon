@using MySalonWeb.ViewModels;
@using static MySalonWeb.ViewModels.BookingViewModel;
@model BookingViewModel
@{
    ViewData["Title"] = "Booking";
}


<!-- model BookingModel-->

<head>

<link rel="stylesheet" href="~/css/bootstrap.min.css">
</head>
<!-- Breadcrumb Area Start -->
    <section class="breadcrumb-area section-padding-80">
        <div class="container">
            <div class="row">
                <div class="col-12">
                    <div class="breadcrumb-content">
                        <h2>Booking</h2>
                        <nav aria-label="breadcrumb">
                            <ol class="breadcrumb">
                                <li class="breadcrumb-item"><a href="home"><i class="icon_house_alt"></i> Home</a></li>
                                <li class="breadcrumb-item active" aria-current="page">Booking</li>
                            </ol>
                        </nav>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <!-- Breadcrumb Area End -->

    <!-- Booking Area Start 
<section class="breadcrumb-area section-padding-80">
    <div class="container">
        <div>
            <form asp-controller="booking" asp-action="" method="post">
                <div class="form-group">
                    <label for="Name">Name:</label>
                    <input asp-for="Name" class="form-control" />
                </div>
            
                <div class="form-group">
                    <label for="Surename">Surename:</label>
                    <input asp-for="Surename" class="form-control" />
                </div>
            
                <div class="form-group">
                    <label for="Phone">Phone:</label>
                    <input asp-for="Phone" class="form-control" />
                </div>
            
                <div class="form-group">
                    <label for="Email">Email:</label>
                    <input asp-for="Email" class="form-control" />
                </div>
            
                <div class="form-group">
                    <label for="Service">Service:</label>
                    <input asp-for="Service" class="form-control" />
                </div>
            
                <div class="form-group">
                    <label for="Date">Date:</label>
                    <input asp-for="Date" class="form-control" />
                </div>

                <button class="btn btn-primary" type="submit">Booking</button>
            </form>
        </div>
    </div>
</section>-->
    <!-- Booking Area End -->

<section class="breadcrumb-area section-padding-80">
    <div class="container">
        <div class="row">
            
            <form asp-action="Booking" method="post">
                <div class="form-group">
                    <label>Name:</label>
                    <p>@Html.TextBoxFor(m => m.Client.Name)</p>
                    <span asp-validation-for="Client.Name" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label>Surename:</label>
                    <p>@Html.TextBoxFor(m => m.Client.Surname) </p>
                    <span asp-validation-for="Client.Surname" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label>Email:</label>
                    <p> @Html.TextBoxFor(m => m.Client.Email) </p>
                    <span asp-validation-for="Client.Email" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <label>Phone:</label>
                    <p id="Client_Phone"> @Html.TextBoxFor(m => m.Client.Phone) </p>
                    <span asp-validation-for="Client.Phone" class="text-danger"></span>
                </div>

                <div class="form-group">
                    <select asp-for="@Model.ServiceType" asp-items="Html.GetEnumSelectList<ServiceTypes>()" class="form-control">
                        <option value="Id">Choose service type</option>
                    </select> 
                </div>

                <div id="ServiceName"> </div>
                <div id="ServiceTime"> </div>
                
                <button class="btn btn-primary " type="submit">Booking</button>
            </form>
        </div>
    </div>
</section>

@section scripts {
    @{
        <script>

              $('#ServiceType').change(function () {
                  var select = (this);
                  var indexSelected = select.selectedIndex;

                $.ajax(
                {
                    type: 'post',
                    url: '@Url.Action("GetConfigForm", "Home")?id=' + indexSelected,
                    data: {},
                    dataType: 'html',
                    success: function (response) {
                    $('#ServiceName').empty();
                    $('#ServiceTime').empty();
                    $('#ServiceName').append(response);
                    },
                    error: function (data) {
                        console.log('error: ', data);
                    }
                })
                  

              });


            $(document).on('change', '#Order_ServiceId', function (e) {
                var select = (this);
                var indexSelected = select.selectedIndex;
                var pickedDate = $("#date").val();
                console.log(indexSelected);
                console.log(pickedDate);
                  if (indexSelected && pickedDate != 0) {
                    $.ajax(
                        {
                            type: 'post',
                            url: '@Url.Action("GetTimeAndPrice", "Home")?id=' + indexSelected + '&date=' + pickedDate,
                            data: {},
                            dataType: 'html',
                            success: function (response) {
                                $('#ServiceTime').empty();
                            $('#ServiceTime').append(response);
                            },
                            error: function (data) {
                                console.log('error: ', data);
                            }
                        })
                  }
                else { console.log("Enter data or service"); }
                
            });

            $(document).on('change', '#date', function (e) {
                var indexSelected = $('#Order_ServiceId').val();
                var pickedDate = $("#date").val();
                console.log(indexSelected);
                console.log(pickedDate);
                if (indexSelected && pickedDate != 0) {
                    $.ajax(
                        {
                            type: 'post',
                            url: '@Url.Action("GetTimeAndPrice", "Home")?id=' + indexSelected + '&date=' + pickedDate,
                            data: {},
                            dataType: 'html',
                            success: function (response) {
                                $('#ServiceTime').empty();
                                $('#ServiceTime').append(response);
                            },
                            error: function (data) {
                                console.log('error: ', data);
                            }
                        })
                }
                else { console.log("Enter data or service"); }

            });
        </script>
}
}
  